<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Painel de Notifica√ß√£o de Eventos Massivos ‚Ä¢ v2.1</title>

<style>
:root{
  --bg:#0b1020;
  --card:#111a33;
  --text:#e9efff;
  --muted:#a9b7e6;
  --border:rgba(255,255,255,.12);
  --field: rgba(17,26,51,.78);
  --radius:18px;
  --btn:#6b5cff;
  --btn2:#16a34a;
  --btn3:#444;
  --warn: rgba(255, 209, 102, .14);
}
[data-theme="clean"]{
  --bg:#f5f7ff;
  --card:#ffffff;
  --text:#0b1020;
  --muted:#4b5563;
  --border:rgba(15,23,42,.14);
  --field: rgba(15,23,42,.04);
  --btn:#5b5cff;
  --btn2:#16a34a;
  --btn3:#e5e7eb;
  --warn: rgba(255, 209, 102, .22);
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
  padding:28px 18px 60px;
}
.wrap{max-width:980px;margin:auto;}
h1{margin:0 0 6px; font-size: clamp(22px, 2.4vw, 32px);}
.subtitle{color:var(--muted);margin:0 0 16px; line-height:1.35}

.badge{
  display:inline-flex;
  gap:10px;
  align-items:center;
  padding:10px 12px;
  border-radius:999px;
  border:1px solid var(--border);
  background: var(--field);
  color:var(--text);
  font-weight:800;
  font-size: 12px;
}
.topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
  flex-wrap:wrap;
  margin: 10px 0 16px;
}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:18px;
}
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
}
@media (max-width:820px){ .grid{grid-template-columns:1fr;} }
.full{grid-column:1/-1}

label{font-weight:850;font-size:14px}
input,select,textarea{
  width:100%;
  padding:12px 14px;
  font-size:16px;
  border-radius:12px;
  border:1px solid var(--border);
  background:var(--field);
  color:var(--text);
  height:44px;
  box-sizing:border-box;
  outline:none;
}
textarea{
  height:auto;
  min-height:110px;
  resize:vertical;
  line-height:1.35;
}
input:focus,select:focus,textarea:focus{
  border-color: rgba(107, 92, 255, .55);
  box-shadow: 0 0 0 4px rgba(107,92,255,.16);
}
.row3{
  display:grid;
  grid-template-columns:1fr 1fr auto;
  gap:10px;
}
@media (max-width:520px){ .row3{grid-template-columns:1fr;} }

.actions{
  margin-top:16px;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
button{
  padding:10px 14px;
  border-radius:12px;
  border:1px solid var(--border);
  background:var(--btn);
  color:white;
  font-weight:850;
  cursor:pointer;
}
.btnGreen{background:var(--btn2);border:0}
.btnGray{
  background:var(--btn3);
  color: var(--text);
}
[data-theme="clean"] .btnGray{ color:#111827; }

.miniBtn{
  padding:10px 12px;
  font-size: 14px;
  white-space:nowrap;
}

.output{
  margin-top:16px;
  width:100%;
  min-height:190px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size: 13.5px;
  white-space: pre;
}
.note{
  margin-top: 10px;
  padding: 10px 12px;
  border-radius: 12px;
  border:1px solid var(--border);
  background: var(--warn);
  color: var(--text);
  font-size: 13px;
}

/* Hist√≥rico */
.historyCard{
  margin-top: 18px;
  padding: 16px;
  border-radius: var(--radius);
  border: 1px solid var(--border);
  background: rgba(255,255,255,.02);
}
[data-theme="clean"] .historyCard{
  background: rgba(15,23,42,.02);
}
.historyTop{
  display:flex;
  justify-content:space-between;
  align-items:flex-end;
  gap:12px;
  flex-wrap:wrap;
  margin-bottom: 10px;
}
.historyTop h2{
  margin:0;
  font-size: 16px;
  letter-spacing:.2px;
}
.historyTop .hint{
  margin:0;
  color:var(--muted);
  font-size: 12px;
}
.historyActions{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}

.searchRow{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  margin: 10px 0 12px;
}
.searchRow input{
  height: 42px;
  flex: 1 1 280px;
}

.tableWrap{
  overflow:auto;
  border-radius: 12px;
  border:1px solid var(--border);
}
table{
  width:100%;
  border-collapse:collapse;
  min-width: 860px;
  background: rgba(0,0,0,.10);
}
[data-theme="clean"] table{ background: rgba(15,23,42,.02); }
th,td{
  padding: 10px 12px;
  border-bottom:1px solid var(--border);
  text-align:left;
  vertical-align:top;
  font-size: 13px;
}
th{ font-size:12px; color: var(--muted); letter-spacing:.2px; }
td .mono{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  white-space: pre;
}

.small{
  color: var(--muted);
  font-size: 12px;
  margin-top: 4px;
}
.rowBtns{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}
.rowBtns button{
  padding:8px 10px;
  border-radius:10px;
  font-size: 12px;
  font-weight: 850;
}
.danger{
  background: rgba(239,68,68,.18);
  border: 1px solid rgba(239,68,68,.30);
}
.toast{
  margin-top: 10px;
  padding: 10px 12px;
  border-radius: 12px;
  border:1px solid var(--border);
  background: rgba(34,197,94,.10);
  color: var(--text);
  font-size: 13px;
  display:none;
}
.toast.err{ background: rgba(239,68,68,.10); }
</style>
</head>

<body>
<div class="wrap">
  <div class="topbar">
    <div>
      <h1>Painel de Notifica√ß√£o de Eventos Massivos</h1>
      <p class="subtitle">
        Registro padronizado para comunica√ß√£o operacional aos gestores (WhatsApp). Gera texto com t√≠tulos em <b>*negrito*</b> e mant√©m hist√≥rico local no navegador.
      </p>
    </div>
    <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;">
      <span class="badge">Vers√£o 2.1</span>
      <button class="btnGray" type="button" id="btnTema">üåó Modo: Dark</button>
    </div>
  </div>

  <div class="card">
    <div id="toast" class="toast"></div>

    <div class="grid">

      <div class="full">
        <label for="centro">CENTRO LOCAL INFORMA</label>
        <select id="centro">
          <option>ROMPIMENTO DE FIBRA EMPRESARIAL</option>
          <option>FALHA DE EQUIPAMENTO</option>
          <option>SWAP</option>
          <option>ATIVIDADE PROGRAMADA</option>
        </select>
      </div>

      <div>
        <label for="uf">UF</label>
        <select id="uf">
          <option>AC</option><option>DF</option><option>GO</option>
          <option>MS</option><option>MT</option>
          <option>TO</option><option>RO</option>
        </select>
      </div>

      <div>
        <label for="cf">CF</label>
        <input id="cf" placeholder="">
      </div>

      <!-- NOVO CAMPO V2.1 -->
      <div>
        <label for="recRalRef">REC/RAL (Refer√™ncia)</label>
        <input id="recRalRef" placeholder="">
      </div>

      <div>
        <label for="designacao">DESIGNA√á√ÉO</label>
        <input id="designacao" placeholder="">
      </div>

      <div>
        <label for="rals">IMPACTO - RALS</label>
        <select id="rals"></select>
      </div>

      <div>
        <label for="recs">IMPACTO - RECS</label>
        <select id="recs"></select>
      </div>

      <div class="full">
        <label>HOR√ÅRIO DE ABERTURA</label>
        <div class="row3">
          <input type="date" id="abData">
          <input type="time" id="abHora">
          <button class="btnGray miniBtn" type="button" id="abAgora">‚è±Ô∏è Agora</button>
        </div>
      </div>

      <div class="full">
        <label>HOR√ÅRIO DE RECEBIMENTO NO CENTRO LOCAL</label>
        <div class="row3">
          <input type="date" id="recData">
          <input type="time" id="recHora">
          <button class="btnGray miniBtn" type="button" id="recAgora">‚è±Ô∏è Agora</button>
        </div>
      </div>

      <div class="full">
        <label>HOR√ÅRIO DE ACIONAMENTO T√âCNICO</label>
        <div class="row3">
          <input type="date" id="acData">
          <input type="time" id="acHora">
          <button class="btnGray miniBtn" type="button" id="acAgora">‚è±Ô∏è Agora</button>
        </div>
      </div>

      <div class="full">
        <label for="motivo">MOTIVO</label>
        <textarea id="motivo" placeholder=""></textarea>
      </div>

      <div class="full">
        <label for="status">STATUS</label>
        <textarea id="status" placeholder=""></textarea>
      </div>

    </div>

    <div class="actions">
      <button type="button" id="btnGerar">üßæ Gerar texto</button>
      <button type="button" class="btnGreen" id="btnCopiar">üìã Copiar</button>
      <button type="button" class="btnGray" id="btnWhats">üì≤ Abrir WhatsApp</button>
      <button type="button" class="btnGray" id="btnLimpar">üßΩ Limpar</button>
    </div>

    <textarea id="saida" class="output" readonly placeholder="Clique em ‚ÄúGerar texto‚Äù e o conte√∫do aparece aqui‚Ä¶"></textarea>

    <div class="note">
      Dica operacional: use ‚ÄúGerar‚Äù ‚Üí ‚ÄúCopiar‚Äù e cole no grupo dos gestores. O bot√£o ‚ÄúAbrir WhatsApp‚Äù √© apenas atalho (pode variar conforme o dispositivo).
    </div>
  </div>

  <div class="historyCard">
    <div class="historyTop">
      <div>
        <h2>Hist√≥rico local</h2>
        <p class="hint">Fica salvo no navegador deste computador (localStorage). N√£o √© sincronizado entre m√°quinas.</p>
      </div>
      <div class="historyActions">
        <button class="btnGray" type="button" id="btnCSV">‚¨áÔ∏è Exportar CSV</button>
        <button class="btnGray danger" type="button" id="btnClearHist">üß® Limpar hist√≥rico</button>
      </div>
    </div>

    <div class="searchRow">
      <input id="search" type="text" placeholder="Buscar no hist√≥rico (UF, CF, refer√™ncia, designa√ß√£o, motivo, status‚Ä¶)" />
      <button class="btnGray" type="button" id="btnRefresh">üîé Atualizar</button>
    </div>

    <div class="tableWrap">
      <table>
        <thead>
          <tr>
            <th>Registrado</th>
            <th>UF</th>
            <th>CF / Refer√™ncia</th>
            <th>Designa√ß√£o</th>
            <th>Impacto</th>
            <th>Hor√°rios</th>
            <th>Texto</th>
            <th>A√ß√µes</th>
          </tr>
        </thead>
        <tbody id="historyBody"></tbody>
      </table>
    </div>

    <p class="small" id="historyCount"></p>
  </div>
</div>

<script>
/* ========= DOM seguro ========= */
const $ = (id) => document.getElementById(id);

const el = {
  toast: $("toast"),
  btnTema: $("btnTema"),
  centro: $("centro"),
  uf: $("uf"),
  cf: $("cf"),
  recRalRef: $("recRalRef"),   // V2.1
  designacao: $("designacao"),
  rals: $("rals"),
  recs: $("recs"),
  abData: $("abData"),
  abHora: $("abHora"),
  recData: $("recData"),
  recHora: $("recHora"),
  acData: $("acData"),
  acHora: $("acHora"),
  abAgora: $("abAgora"),
  recAgora: $("recAgora"),
  acAgora: $("acAgora"),
  motivo: $("motivo"),
  status: $("status"),
  saida: $("saida"),
  btnGerar: $("btnGerar"),
  btnCopiar: $("btnCopiar"),
  btnWhats: $("btnWhats"),
  btnLimpar: $("btnLimpar"),
  btnCSV: $("btnCSV"),
  btnClearHist: $("btnClearHist"),
  search: $("search"),
  btnRefresh: $("btnRefresh"),
  historyBody: $("historyBody"),
  historyCount: $("historyCount")
};

/* ========= Toast ========= */
function showToast(msg, isErr=false){
  el.toast.textContent = msg;
  el.toast.classList.toggle("err", isErr);
  el.toast.style.display = "block";
  clearTimeout(showToast._t);
  showToast._t = setTimeout(()=> el.toast.style.display="none", 3500);
}

/* ========= Helpers ========= */
function pad(n){return String(n).padStart(2,"0")}
function setNow(dateEl, timeEl){
  const now=new Date();
  dateEl.value = now.getFullYear()+"-"+pad(now.getMonth()+1)+"-"+pad(now.getDate());
  timeEl.value = pad(now.getHours())+":"+pad(now.getMinutes());
}
function format(dateEl, timeEl){
  const data = dateEl.value;   // yyyy-mm-dd
  const hora = timeEl.value;   // HH:MM
  if(!data || !hora) return "";
  const [y,m,day]=data.split("-");
  return `${day}/${m}/${y.slice(2)} ${hora}`;
}
function line(label, value){
  return `*${label}:* ${value || ""}`;
}
function safeTrim(v){ return (v ?? "").toString().trim(); }

/* ========= Dropdown 0..500 ========= */
function fillRange(selectEl, min, max){
  selectEl.innerHTML = "";
  for(let i=min;i<=max;i++){
    const o=document.createElement("option");
    o.value = String(i);
    o.textContent = String(i);
    selectEl.appendChild(o);
  }
}
fillRange(el.rals, 0, 500);
fillRange(el.recs, 0, 500);

/* ========= Tema (memorizado) ========= */
function setTheme(mode){
  document.documentElement.setAttribute("data-theme", mode);
  localStorage.setItem("temaFormV21", mode);
  el.btnTema.textContent = (mode==="clean") ? "üåû Modo: Clean" : "üåó Modo: Dark";
}
function toggleTheme(){
  const current = document.documentElement.getAttribute("data-theme") || "dark";
  setTheme(current === "clean" ? "dark" : "clean");
}
el.btnTema.addEventListener("click", toggleTheme);
setTheme(localStorage.getItem("temaFormV21") || "dark");

/* ========= WhatsApp (atalho universal) ========= */
function abrirWhatsApp(){
  const ua = navigator.userAgent.toLowerCase();
  if(ua.includes("windows")){
    window.location.href = "whatsapp://send";
    return;
  }
  if(/android|iphone|ipad/i.test(ua)){
    window.open("https://wa.me/", "_blank");
    return;
  }
  window.open("https://web.whatsapp.com/", "_blank");
}

/* ========= Hist√≥rico local ========= */
const STORAGE_KEY = "eventosMassivosHistoricoV21";

function getHistory(){
  try{ return JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]"); }
  catch{ return []; }
}
function setHistory(arr){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
}

function newId(){
  if(window.crypto?.randomUUID) return crypto.randomUUID();
  return String(Date.now()) + "_" + Math.random().toString(16).slice(2);
}

/* ========= Texto ========= */
function buildText(){
  return [
    line("CENTRO LOCAL INFORMA", el.centro.value),
    line("UF", el.uf.value),
    line("CF", safeTrim(el.cf.value)),
    line("REC/RAL (Refer√™ncia)", safeTrim(el.recRalRef.value)),  // V2.1
    line("DESIGNA√á√ÉO", safeTrim(el.designacao.value)),
    line("IMPACTO - RALS", el.rals.value),
    line("IMPACTO - RECS", el.recs.value),
    line("HOR√ÅRIO DE ABERTURA", format(el.abData, el.abHora)),
    line("HOR√ÅRIO DE RECEBIMENTO NO CENTRO LOCAL", format(el.recData, el.recHora)),
    line("HOR√ÅRIO DE ACIONAMENTO T√âCNICO", format(el.acData, el.acHora)),
    line("MOTIVO", safeTrim(el.motivo.value)),
    line("STATUS", safeTrim(el.status.value))
  ].join("\n");
}

function gerar(){
  const texto = buildText();
  el.saida.value = texto;

  const now = new Date();
  const item = {
    id: newId(),
    createdAt: now.toISOString(),
    centro: el.centro.value,
    uf: el.uf.value,
    cf: safeTrim(el.cf.value),
    recRalRef: safeTrim(el.recRalRef.value), // V2.1
    designacao: safeTrim(el.designacao.value),
    rals: el.rals.value,
    recs: el.recs.value,
    abertura: format(el.abData, el.abHora),
    recebimento: format(el.recData, el.recHora),
    acionamento: format(el.acData, el.acHora),
    motivo: safeTrim(el.motivo.value),
    status: safeTrim(el.status.value),
    texto
  };

  const hist = getHistory();
  hist.unshift(item);
  setHistory(hist);

  renderHistory();
  showToast("Texto gerado e salvo no hist√≥rico. ‚úîÔ∏è");
}

async function copiarTexto(texto){
  try{
    await navigator.clipboard.writeText(texto);
    return true;
  }catch{
    return false;
  }
}

async function copiar(){
  const texto = el.saida.value;
  if(!texto.trim()){
    showToast("Gere o texto primeiro.", true);
    return;
  }
  const ok = await copiarTexto(texto);
  if(!ok){
    el.saida.focus();
    el.saida.select();
    document.execCommand("copy");
  }
  showToast("Copiado. üìã‚úîÔ∏è");
}

function limpar(){
  el.cf.value = "";
  el.recRalRef.value = ""; // V2.1
  el.designacao.value = "";
  el.abData.value = "";
  el.abHora.value = "";
  el.recData.value = "";
  el.recHora.value = "";
  el.acData.value = "";
  el.acHora.value = "";
  el.motivo.value = "";
  el.status.value = "";
  el.saida.value = "";
  showToast("Campos limpos. üßº");
}

/* ========= Render hist√≥rico ========= */
function fmtCreated(iso){
  const d = new Date(iso);
  const dd = pad(d.getDate());
  const mm = pad(d.getMonth()+1);
  const yy = String(d.getFullYear()).slice(2);
  const HH = pad(d.getHours());
  const Min = pad(d.getMinutes());
  return `${dd}/${mm}/${yy} ${HH}:${Min}`;
}

function escapeHtml(s){
  return (s || "")
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;");
}

function matchesSearch(item, q){
  if(!q) return true;
  const blob = [
    item.uf, item.cf, item.recRalRef, item.designacao, item.centro, item.motivo, item.status,
    item.abertura, item.recebimento, item.acionamento,
    item.rals, item.recs
  ].join(" ").toLowerCase();
  return blob.includes(q);
}

function renderHistory(){
  const q = safeTrim(el.search.value).toLowerCase();
  const hist = getHistory();
  const filtered = hist.filter(it => matchesSearch(it, q));

  el.historyBody.innerHTML = "";

  for(const item of filtered){
    const tr = document.createElement("tr");

    const tdCreated = document.createElement("td");
    tdCreated.textContent = fmtCreated(item.createdAt);
    tr.appendChild(tdCreated);

    const tdUF = document.createElement("td");
    tdUF.textContent = item.uf || "";
    tr.appendChild(tdUF);

    const tdCFRef = document.createElement("td");
    tdCFRef.innerHTML = `${escapeHtml(item.cf || "")}<div class="small">Ref: ${escapeHtml(item.recRalRef || "")}</div>`;
    tr.appendChild(tdCFRef);

    const tdDes = document.createElement("td");
    tdDes.textContent = item.designacao || "";
    tr.appendChild(tdDes);

    const tdImp = document.createElement("td");
    tdImp.innerHTML = `<div><b>RALS:</b> ${escapeHtml(item.rals)}</div><div><b>RECS:</b> ${escapeHtml(item.recs)}</div>`;
    tr.appendChild(tdImp);

    const tdTimes = document.createElement("td");
    tdTimes.innerHTML =
      `<div><b>Abertura:</b> ${escapeHtml(item.abertura || "")}</div>
       <div><b>Receb:</b> ${escapeHtml(item.recebimento || "")}</div>
       <div><b>Acion:</b> ${escapeHtml(item.acionamento || "")}</div>`;
    tr.appendChild(tdTimes);

    const tdText = document.createElement("td");
    const preview = (item.texto || "");
    tdText.innerHTML = `<div class="mono">${escapeHtml(preview).slice(0, 420)}${preview.length>420?"‚Ä¶":""}</div>`;
    tr.appendChild(tdText);

    const tdBtns = document.createElement("td");
    tdBtns.innerHTML = `
      <div class="rowBtns">
        <button class="btnGreen" type="button" data-act="use" data-id="${escapeHtml(item.id)}">Usar</button>
        <button class="btnGray" type="button" data-act="copy" data-id="${escapeHtml(item.id)}">Copiar</button>
        <button class="btnGray danger" type="button" data-act="del" data-id="${escapeHtml(item.id)}">Excluir</button>
      </div>
    `;
    tr.appendChild(tdBtns);

    el.historyBody.appendChild(tr);
  }

  el.historyCount.textContent = `Registros: ${filtered.length} (total armazenado: ${getHistory().length}).`;
}

/* Delega√ß√£o de eventos na tabela */
el.historyBody.addEventListener("click", async (ev) => {
  const btn = ev.target.closest("button[data-act]");
  if(!btn) return;
  const act = btn.getAttribute("data-act");
  const id = btn.getAttribute("data-id");
  const hist = getHistory();
  const item = hist.find(x => x.id === id);
  if(!item) return;

  if(act === "use"){
    el.centro.value = item.centro || el.centro.value;
    el.uf.value = item.uf || el.uf.value;
    el.cf.value = item.cf || "";
    el.recRalRef.value = item.recRalRef || ""; // V2.1
    el.designacao.value = item.designacao || "";
    el.rals.value = item.rals || "0";
    el.recs.value = item.recs || "0";
    el.motivo.value = item.motivo || "";
    el.status.value = item.status || "";
    el.saida.value = item.texto || "";
    window.scrollTo({top:0, behavior:"smooth"});
    showToast("Registro carregado. ‚úîÔ∏è");
    return;
  }

  if(act === "copy"){
    const ok = await copiarTexto(item.texto || "");
    if(!ok){
      el.saida.value = item.texto || "";
      el.saida.focus();
      el.saida.select();
      document.execCommand("copy");
    }
    showToast("Registro copiado. üìã‚úîÔ∏è");
    return;
  }

  if(act === "del"){
    const newHist = hist.filter(x => x.id !== id);
    setHistory(newHist);
    renderHistory();
    showToast("Registro exclu√≠do.");
  }
});

/* ========= CSV / Limpar Hist√≥rico ========= */
function csvEscape(v){
  const s = String(v ?? "");
  if(/[",\n]/.test(s)) return `"${s.replaceAll('"','""')}"`;
  return s;
}

function exportCSV(){
  const hist = getHistory();
  if(hist.length === 0){
    showToast("Hist√≥rico vazio.", true);
    return;
  }
  const header = [
    "createdAt","uf","cf","recRalRef","designacao","centro","rals","recs",
    "abertura","recebimento","acionamento","motivo","status","texto"
  ];
  const rows = [header.join(",")];
  for(const it of hist){
    rows.push(header.map(k => csvEscape(it[k])).join(","));
  }

  const blob = new Blob([rows.join("\n")], {type:"text/csv;charset=utf-8"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  const ts = new Date().toISOString().slice(0,19).replace(/[:T]/g,"-");
  a.href = url;
  a.download = `historico_eventos_massivos_${ts}.csv`;
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);

  showToast("CSV exportado. ‚¨áÔ∏è");
}

function clearHistory(){
  const ok = confirm("Tem certeza que deseja apagar TODO o hist√≥rico local deste navegador?");
  if(!ok) return;
  localStorage.removeItem(STORAGE_KEY);
  renderHistory();
  showToast("Hist√≥rico apagado.");
}

/* ========= Wire-up ========= */
el.abAgora.addEventListener("click", ()=> setNow(el.abData, el.abHora));
el.recAgora.addEventListener("click", ()=> setNow(el.recData, el.recHora));
el.acAgora.addEventListener("click", ()=> setNow(el.acData, el.acHora));

el.btnGerar.addEventListener("click", gerar);
el.btnCopiar.addEventListener("click", copiar);
el.btnWhats.addEventListener("click", abrirWhatsApp);
el.btnLimpar.addEventListener("click", limpar);

el.btnCSV.addEventListener("click", exportCSV);
el.btnClearHist.addEventListener("click", clearHistory);
el.btnRefresh.addEventListener("click", renderHistory);
el.search.addEventListener("input", renderHistory);

/* Inicializa tabela */
renderHistory();
</script>
</body>
</html>

